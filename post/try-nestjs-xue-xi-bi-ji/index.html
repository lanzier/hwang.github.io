<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Try Nest.js â€”â€” å­¦ä¹ ç¬”è®° | Hwang&#39;s Blog</title>
<meta name="description" content="<div>
æ¬¢è¿æ¥åˆ° Hwang çš„å°åšå®¢ 
<div style="font-size:10px">
ğŸ“š åšå®¢é€šè¿‡ Gridea æ­å»ºï¼Œæ„Ÿè°¢ Gridea çš„å…è´¹æœåŠ¡ï¼›è¹­åœ¨ Githubï¼Œæ„Ÿè°¢ Github.com æä¾›çš„æœåŠ¡å™¨èµ„æº  <br>
âœï¸ æ–‡ç« ç”± Hwangï¼Œåœ¨ Ulysses ä¸Šå®Œæˆå†™ä½œ/äº¦æˆ–è€…æ‹·è´<br>
ğŸ‘¨â€ğŸ¨ å°é¢ç”± Hwangï¼Œåœ¨ Figma ä¸Šå®Œæˆåˆ›ä½œ <br>
è¿™é‡Œæ˜¾ç„¶ä¸æ˜¯ä»€ä¹ˆæŠ€æœ¯åšå®¢ï¼Œä¹Ÿä¸ä¼šæœ‰å¤ªå¤šå€¼å¾—æœŸå¾…çš„å¹²è´§ã€‚
</div>
</div>" />
<link rel="shortcut icon" href="https://hwang.top/favicon.ico?v=1582702032945">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://hwang.top/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://hwang.top">
  <img class="avatar" src="https://hwang.top/images/avatar.png?v=1582702032945" alt="">
  </a>
  <h1 class="site-title">
    Hwang&#39;s Blog
  </h1>
  <p class="site-description">
    <div>
æ¬¢è¿æ¥åˆ° Hwang çš„å°åšå®¢ 
<div style="font-size:10px">
ğŸ“š åšå®¢é€šè¿‡ Gridea æ­å»ºï¼Œæ„Ÿè°¢ Gridea çš„å…è´¹æœåŠ¡ï¼›è¹­åœ¨ Githubï¼Œæ„Ÿè°¢ Github.com æä¾›çš„æœåŠ¡å™¨èµ„æº  <br>
âœï¸ æ–‡ç« ç”± Hwangï¼Œåœ¨ Ulysses ä¸Šå®Œæˆå†™ä½œ/äº¦æˆ–è€…æ‹·è´<br>
ğŸ‘¨â€ğŸ¨ å°é¢ç”± Hwangï¼Œåœ¨ Figma ä¸Šå®Œæˆåˆ›ä½œ <br>
è¿™é‡Œæ˜¾ç„¶ä¸æ˜¯ä»€ä¹ˆæŠ€æœ¯åšå®¢ï¼Œä¹Ÿä¸ä¼šæœ‰å¤ªå¤šå€¼å¾—æœŸå¾…çš„å¹²è´§ã€‚
</div>
</div>
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Try Nest.js â€”â€” å­¦ä¹ ç¬”è®°
            </h2>
            <div class="post-info">
              <span>
                2020-02-18
              </span>
              <span>
                7 min read
              </span>
              
                <a href="https://hwang.top/tag/3mZUDuta5/" class="post-tag">
                  # nest.js
                </a>
              
                <a href="https://hwang.top/tag/1N18kZg6K_/" class="post-tag">
                  # Node.js
                </a>
              
                <a href="https://hwang.top/tag/L-iS2h6gS/" class="post-tag">
                  # javaScript
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://hwang.top/post-images/try-nestjs-xue-xi-bi-ji.png" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <blockquote>
<p>ç”¨åˆ°å•¥å­¦å•¥ç³»åˆ—<br>
å…¶å®ä¹Ÿæ˜¯ä¸ºäº†å¦ä¸€ä¸ªå°é¡¹ç›®å†™ä¸€ä¸ªå°åç«¯ã€‚<br>
æ¨èå‚è€ƒ -&gt; å»è¿™çœ‹å§ï¼Œéå¸¸æ¸…æ¥šï¼š <a href="https://tc9011.com/2019/07/14/nestjs%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89/">https://tc9011.com/2019/07/14/nestjs%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89/</a></p>
</blockquote>
<!-- more -->
<h2 id="1-ä»€ä¹ˆæ˜¯-nestjs">1. ä»€ä¹ˆæ˜¯ Nest.js</h2>
<blockquote>
<p>Nestjs æ˜¯ Node æ¸è¿›å¼æ¡†æ¶ï¼Œåº•å±‚é»˜è®¤ä½¿ç”¨ expressï¼ˆå¯ä»¥é€šè¿‡ Adapter è½¬æ¢åˆ° fastifyï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ express æˆ–è€… fastify æ‰€æœ‰ä¸­é—´ä»¶ï¼Œå®Œç¾æ”¯æŒ TypeScriptã€‚ç†Ÿæ‚‰ Spring å’Œ Angular çš„åŒå­¦å¯ä»¥å¾ˆå¿«ä¸Šæ‰‹ Nestjsï¼Œå®ƒå¤§é‡å€Ÿé‰´äº† Spring å’Œ Angular ä¸­çš„è®¾è®¡æ€æƒ³</p>
</blockquote>
<h2 id="2-æ ¸å¿ƒç†å¿µ">2. æ ¸å¿ƒç†å¿µ</h2>
<ul>
<li>
<p>Dependency Injection (DI)ï¼Œä¸€èˆ¬ç¿»è¯‘ä¸º ä¾èµ–æ³¨å…¥ï¼›</p>
</li>
<li>
<p>Inversion of Control ï¼ˆloCï¼‰ï¼Œæ§åˆ¶åè½¬ï¼šä¸»è¦ç”¨é™ä½ä»£ç è€¦åˆåº¦ï¼›ç›¸å½“äºæ˜¯ç”¨ä¸€ä¸ªä¸­è½¬çš„å‡½æ•°æ¥æŠ½è±¡åŸæ¥ç±»é‡Œé¢éœ€è¦çš„å˜é‡ï¼Œè¿™æ ·å°±å®ç°äº†è€¦åˆåº¦çš„é™ä½ã€‚</p>
<ul>
<li>åœ¨ nest.jsä¸­ï¼Œé€šè¿‡ <code>@Injectable()</code> è£…é¥°å™¨æ¥åƒ loC å®¹æ˜“æ³¨å†Œã€‚</li>
</ul>
</li>
<li>
<p>æ¨¡å—åŒ–ï¼šModule æŠŠcontrollerã€serviceå’Œpipeç­‰æ‰“åŒ…æˆå†…èšçš„åŠŸèƒ½å—ï¼Œæ¯ä¸ªæ¨¡å—èšç„¦äºä¸€ä¸ªç‰¹æ€§åŒºåŸŸã€ä¸šåŠ¡é¢†åŸŸã€å·¥ä½œæµæˆ–é€šç”¨å·¥å…·ã€‚</p>
<ul>
<li>æ¯ä¸ªå±äºè¿™ä¸ªæ¨¡å—çš„controllerã€serviceç­‰éƒ½éœ€è¦åœ¨è¿™ä¸ªæ¨¡å—ä¸­æ³¨å†Œï¼Œå¦‚æœéœ€è¦å¼•å…¥å…¶ä»–æ¨¡å—æˆ–è€…ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œéœ€è¦å°†å®ƒæ³¨å†Œåˆ°importsï¼Œé€šè¿‡exportså¯ä»¥å°†ç›¸åº”çš„serviceã€moduleç­‰å…±äº«å‡ºå»ã€‚</li>
<li>åœ¨ nest.jsä¸­ï¼Œé€šè¿‡ <code>@Module()</code> è£…é¥°å™¨æ¥åƒå£°æ˜ä¸€ä¸ªæ¨¡å—ï¼›</li>
</ul>
</li>
<li>
<p>AOP, é¢å‘åˆ‡ç‰‡ç¼–ç¨‹ï¼ˆAspect Oriented Programmingï¼‰ï¼Œä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªåˆ‡ç‰‡ï¼š</p>
<ul>
<li>Middlewaresï¼šä¸­é—´é”®</li>
<li>Guardsï¼šGuards å’Œå‰ç«¯è·¯ç”±ä¸­çš„è·¯ç”±å®ˆå«ä¸€æ ·ï¼Œä¸»è¦ç¡®å®šè¯·æ±‚æ˜¯å¦åº”è¯¥ç”±è·¯ç”±å¤„ç†ç¨‹åºå¤„ç†ã€‚é€šè¿‡å®ˆå«å¯ä»¥çŸ¥é“å°†è¦æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ‰€ä»¥å’Œ middleware ç›¸æ¯”ï¼Œå®ˆå«å¯ä»¥ç¡®åˆ‡çŸ¥é“å°†è¦æ‰§è¡Œä»€ä¹ˆã€‚</li>
<li>Interceptors (åœ¨æµè¢«æ“çºµä¹‹å‰)ï¼šå¯ä»¥ç»™æ¯ä¸€ä¸ªéœ€è¦æ‰§è¡Œçš„å‡½æ•°ç»‘å®šï¼Œæ‹¦æˆªå™¨å°†åœ¨è¯¥å‡½æ•°æ‰§è¡Œå‰æˆ–è€…æ‰§è¡Œåè¿è¡Œã€‚å¯ä»¥è½¬æ¢å‡½æ•°æ‰§è¡Œåè¿”å›çš„ç»“æœï¼Œæ‰©å±•åŸºæœ¬å‡½æ•°è¡Œä¸ºç­‰ã€‚</li>
<li>Pipesï¼šæ˜¯å…·æœ‰ @Injectable() è£…é¥°å™¨çš„ç±»ï¼Œå¹¶å®ç°äº† PipeTransform æ¥å£ã€‚é€šå¸¸ pipe ç”¨æ¥å°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºæ‰€éœ€çš„è¾“å‡ºæˆ–è€…å¤„ç†éªŒè¯ã€‚
<ul>
<li>å‚æ•°éªŒè¯ç­‰å†…å®¹</li>
</ul>
</li>
<li>Interceptors (åœ¨æµè¢«æ“çºµä¹‹å)</li>
<li>Exception filters (å¦‚æœå‘ç°ä»»ä½•å¼‚å¸¸)ï¼šå†…ç½®çš„ Exception filters è´Ÿè´£å¤„ç†æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä¹Ÿæ˜¯ Nestjs ä¸­åœ¨ response å‰ï¼Œæœ€åèƒ½æ•è·å¼‚å¸¸çš„æœºä¼šã€‚</li>
</ul>
</li>
<li>
<p>DTOï¼šæ•°æ®è®¿é—®å¯¹è±¡ç®€ç§°DTOï¼ˆData Transfer Objectï¼‰ï¼Œ æ˜¯ä¸€ç»„éœ€è¦è·¨è¿›ç¨‹æˆ–ç½‘ç»œè¾¹ç•Œä¼ è¾“çš„èšåˆæ•°æ®çš„ç®€å•å®¹å™¨ã€‚å®ƒä¸åº”è¯¥åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶å°†å…¶è¡Œä¸ºé™åˆ¶ä¸ºè¯¸å¦‚å†…éƒ¨ä¸€è‡´æ€§æ£€æŸ¥å’ŒåŸºæœ¬éªŒè¯ä¹‹ç±»çš„æ´»åŠ¨ã€‚</p>
</li>
<li>
<p>ORM ï¼šæ˜¯â€å¯¹è±¡-å…³ç³»æ˜ å°„â€ï¼ˆObject/Relational Mappingï¼‰ çš„ç¼©å†™ï¼Œé€šè¿‡å®ä¾‹å¯¹è±¡çš„è¯­æ³•ï¼Œå®Œæˆå…³ç³»å‹æ•°æ®åº“çš„æ“ä½œã€‚é€šè¿‡ ORM å°±å¯ä»¥ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ–¹å¼å»æ“ä½œå…³ç³»å‹æ•°æ®åº“ã€‚</p>
<ul>
<li>åœ¨ Java ä¸­ï¼Œå¸¸ç”¨ DAO ï¼ˆData Access Objectï¼Œ æ•°æ®è®¿é—®å¯¹è±¡ï¼‰å±‚æ¥è¿›è¡Œå„ç§æ•°æ®åº“çš„æ“ä½œã€‚DAO ä¸»è¦ä½œç”¨æ˜¯åˆ†ç¦»ä¸šåŠ¡å±‚ä¸æ•°æ®å±‚ï¼Œé¿å…ä¸šåŠ¡å±‚ä¸æ•°æ®å±‚è€¦åˆã€‚</li>
<li>Nest.js ä¸­å¯ä»¥ä½¿ç”¨ typeORM ä¸º DAO å±‚ï¼Œæ”¯æŒMySQL / MariaDB / Postgres / CockroachDB / SQLite / Microsoft SQL Server / Oracle / MongoDB / NoSQLã€‚åœ¨ typeORM ä¸­æ•°æ®åº“çš„è¡¨å¯¹åº”çš„å°±æ˜¯ä¸€ä¸ªç±»ï¼Œé€šè¿‡å®šä¹‰ä¸€ä¸ªç±»æ¥åˆ›å»ºå®ä½“ã€‚å®ä½“ï¼ˆEntityï¼‰æ˜¯ä¸€ä¸ªæ˜ å°„åˆ°æ•°æ®åº“è¡¨ï¼ˆæˆ–ä½¿ç”¨ MongoDB æ—¶çš„é›†åˆï¼‰çš„ç±»ï¼Œé€šè¿‡@Entity()æ¥æ ‡è®°ï¼Œå…·ä½“çš„ï¼š</li>
</ul>
<pre><code class="language-js">import {Entity, PrimaryGeneratedColumn, Column} from &quot;typeorm&quot;;

@Entity()
export class User {

    @PrimaryGeneratedColumn()
    id: number;

    @Column()
    firstName: string;

    @Column()
    lastName: string;

    @Column()
    age: number;

}
//ä¸Šé¢ä»£ç å°†åˆ›å»ºä»¥ä¸‹æ•°æ®åº“è¡¨ï¼š

//+-------------+--------------+----------------------------+
//|                          user                           |
//+-------------+--------------+----------------------------+
//| id          | int(11)      | PRIMARY KEY AUTO_INCREMENT |
//| firstName   | varchar(255) |                            |
//| lastName    | varchar(255) |                            |
//| isActive    | boolean      |                            |
//+-------------+--------------+----------------------------+
//	ä½¿ç”¨ @InjectRepository() ä¿®é¥°å™¨æ³¨å…¥ å¯¹åº”çš„Repositoryï¼Œå°±å¯ä»¥åœ¨è¿™ä¸ªRepositoryå¯¹è±¡ä¸Šè¿›è¡Œæ•°æ®åº“çš„ä¸€äº›æ“ä½œã€‚

import { Injectable } from '@nestjs/common';
import { InjectRepository } from '@nestjs/typeorm';
import { Repository } from 'typeorm';
import { User } from './user.entity';

@Injectable()
export class UserService {
  constructor(
	@InjectRepository(User)
	private readonly userRepository: Repository&lt;User&gt;,
  ) {}

  async findAll(): Promise&lt;User[]&gt; {
	return await this.userRepository.find();
  }
}
</code></pre>
</li>
</ul>
<h2 id="3-ä¸Šæ‰‹-hello-world">3. ä¸Šæ‰‹ hello world ï¼</h2>
<p>å®‰è£…ï¼š</p>
<pre><code class="language-js">$ npm install -g @nestjs/cli
$ nest new my-awesome-app 
</code></pre>
<p>å¯åŠ¨</p>
<pre><code class="language-js">$ npm start
</code></pre>
<p>è‡ªæ­¤ï¼Œé€šè¿‡<code>http://loaclhost:3000</code> å°±å¯ä»¥çœ‹åˆ° Hello World äº†ã€‚</p>
<h2 id="4-controller">4. Controller</h2>
<p>åœ¨ Nest.js ä¸­ Contraller è´Ÿè´£å¤„ç†ä¼ å…¥çš„è¯·æ±‚ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„ service å®Œæˆå¤„ç†ï¼Œè¿”å›å¯¹å®¢æˆ·ç«¯çš„å“åº”ï¼Œå¯ä»¥é€šè¿‡ CLI æ¥åˆ›å»º controllerï¼š</p>
<pre><code>$nest g co [your-cintroller]
</code></pre>
<p>è¿™æ—¶å€™ï¼ŒCLI ä¼šè‡ªåŠ¨ç”Ÿæˆ controller æ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠ controller æ³¨å†Œåˆ°å¯¹åº”çš„ module ä¸­ã€‚<br>
å¹¶ä¸”å’Œå…¶ä»–ä¸€äº› node æ¡†æ¶ä¸ä¸€æ ·ï¼ŒNestjs è·¯ç”±ä¸æ˜¯é›†ä¸­å¼ç®¡ç†ï¼Œè€Œæ˜¯åˆ†æ•£åœ¨ controller ä¸­ï¼Œé€šè¿‡@controller()ä¸­å£°æ˜çš„ï¼ˆå¯é€‰ï¼‰å‰ç¼€å’Œè¯·æ±‚è£…é¥°å™¨ä¸­æŒ‡å®šçš„ä»»ä½•è·¯ç”±æ¥ç¡®å®šçš„ã€‚</p>
<pre><code class="language-js">import { Controller, Get } from '@nestjs/common';

import { CatsService } from './cats.service';

@Controller('cats')
export class CatsController {
  constructor(private readonly catsService: CatsService) {
  }

  @Get(':id')
  findOne(@Param('id') id: string): string {
    return this.catsService.getCat();
  }
}
</code></pre>
<p>ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œé€šè¿‡ Get è¯·æ±‚å»è¯·æ±‚http://localhost:3000/cats/1å°±ä¼šè°ƒç”¨findOneæ–¹æ³•ã€‚å¦‚æœéœ€è¦è°ƒæ•´ï¼Œæ·»åŠ å‰ç¼€ï¼Œå¯ä»¥åœ¨ main.ts ä¸­ä½¿ç”¨ GlobalPrefix è®¾ç½®ï¼š</p>
<pre><code class="language-js">import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  app.setGlobalPrefix('api/v1');
  await app.listen(3000);
}
bootstrap();
</code></pre>
<h2 id="5-service">5. Service</h2>
<p>åœ¨ Nest.js ä¸­ï¼Œcontroller å°±åƒæ˜¯è°ƒç”¨ service çš„æŒ‡æŒ¥è€…ï¼ŒæŠŠå¯¹åº”çš„è¯·æ±‚åˆ†å‘åˆ°ç›¸åº”çš„ service ä¸­å»å¤„ç†ã€‚åœ¨ controller ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­æ³¨å…¥äº†<strong>CatsService</strong>å®ä¾‹ï¼Œæ¥è°ƒç”¨å¯¹åº” service ä¸­çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯ Nest.js ä¸­ä¾èµ–æ³¨å…¥çš„æ³¨å…¥æ–¹å¼ â€” æ„é€ å‡½æ•°æ³¨å…¥ã€‚service å¯ä»¥çœ‹åšå¤¹åœ¨ controller å’Œ model ä¹‹é—´çš„ä¸€å±‚ï¼Œåœ¨ service è°ƒç”¨ DAO ï¼ˆåœ¨ Nestjs ä¸­æ˜¯å„ç§ ORM å·¥å…·æˆ–è€…è‡ªå·±å°è£…çš„ DAO å±‚ï¼‰å®ç°æ•°æ®åº“çš„è®¿é—®ï¼Œè¿›è¡Œæ•°æ®çš„å¤„ç†æ•´åˆã€‚</p>
<pre><code>import { Injectable } from '@nestjs/common';

@Injectable()
export class CatsService {
  getCat(id: string): string {
    return `This action returns ${id} cats`;
  }
}
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­é€šè¿‡@Injectable()å®šä¹‰äº†ä¸€ä¸ª serviceï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨å…¶ä»– controller æˆ–è€… service ä¸­æ³¨å…¥è¿™ä¸ª serviceã€‚</p>
<hr>
<p>å‚è€ƒï¼š<a href="https://tc9011.com/2019/07/22/nestjs%E5%85%A5%E9%97%A8%EF%BC%88%E4%BA%8C%EF%BC%89/">https://tc9011.com/2019/07/22/nestjs%E5%85%A5%E9%97%A8%EF%BC%88%E4%BA%8C%EF%BC%89/</a></p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#1-%E4%BB%80%E4%B9%88%E6%98%AF-nestjs">1. ä»€ä¹ˆæ˜¯ Nest.js</a></li>
<li><a href="#2-%E6%A0%B8%E5%BF%83%E7%90%86%E5%BF%B5">2. æ ¸å¿ƒç†å¿µ</a></li>
<li><a href="#3-%E4%B8%8A%E6%89%8B-hello-world">3. ä¸Šæ‰‹ hello world ï¼</a></li>
<li><a href="#4-controller">4. Controller</a></li>
<li><a href="#5-service">5. Service</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://hwang.top/post/try-electron-ji-shi-ba-zu-jian-chuan-can-electron-node-mo-kuai-zhi-chi-wen-ti-wen-jian-lu-jing-wen-ti/">
              <h3 class="post-title">
                Try Electronè®°å®ï¼ˆå…«ï¼‰â€” ç»„ä»¶ä¼ å‚\ Electron Node æ¨¡å—æ”¯æŒé—®é¢˜ \æ–‡ä»¶è·¯å¾„é—®é¢˜ 
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://hwang.top/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()

  let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

  // This should probably be throttled.
  // Especially because it triggers during smooth scrolling.
  // https://lodash.com/docs/4.17.10#throttle
  // You could do like...
  // window.addEventListener("scroll", () => {
  //    _.throttle(doThatStuff, 100);
  // });
  // Only not doing it here to keep this Pen dependency-free.

  window.addEventListener("scroll", event => {
    let fromTop = window.scrollY;

    mainNavLinks.forEach((link, index) => {
      let section = document.getElementById(decodeURI(link.hash).substring(1));
      let nextSection = null
      if (mainNavLinks[index + 1]) {
        nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
      }
      console.log('section.offsetHeight', section.offsetHeight);
      if (section.offsetTop <= fromTop) {
        if (nextSection) {
          if (nextSection.offsetTop > fromTop) {
            link.classList.add("current");
          } else {
            link.classList.remove("current");    
          }
        } else {
          link.classList.add("current");
        }
      } else {
        link.classList.remove("current");
      }
    });
  });

</script>

      </div>
    </div>
  </body>
</html>
